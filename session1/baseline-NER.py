#! /usr/bin/python3

import sys
from os import listdir, system

from dom.minidom import parse
from nltk.tokenize import word_tokenize
from util import evaluator

## dictionary containig information from external knowledge resources
## WARNING: You may need to adjust the path to the resource files
external = {}
with open("./resources/HSDB.txt", encoding='utf8') as h :
    for x in h.readlines() :
        external[x.strip().lower()] = "drug"
with open("./resources/DrugBank.txt", encoding='utf8') as h :
    for x in h.readlines() :
        (n,t) = x.strip().lower().split("|")
        external[n] = t

        
## --------- tokenize sentence ----------- 
## -- Tokenize sentence, returning tokens and span offsets

def tokenize(txt):
    offset = 0
    tks = []
    for t in word_tokenize(txt):
        offset = txt.find(t, offset)
        tks.append((t, offset, offset+len(t)-1))
        offset += len(t)
    return tks

## -----------------------------------------------
## -- check if a token is a drug part, and of which type

suffixes_5 = ['azole', 'idine', 'amine', 'mycin']
suffixes_3 = ['mab', 'nib', 'mib']
suffix_drug_n = ['statin']
all_drug_prefix = ['cef-', 'ceph-', 'pred-', 'sulfa-','tretin-']
all_drug_suffix = ['-asone','-afil','-asone','-bicin','-bital','-caine','-cillin','-cycline','-dazole','-dipine','-dronate','-afil','-asone','-bicin','-bital','-caine','-cillin','-cycline','-dazole','-dipine','-dronate','-eprazole','-fenac','-floxacin','-gliptin','-glitazone','-iramine','-lamide','-mab','-mustine','-mycin','-nacin','-olol','-olone','-olone','-onide','-oprazole','-parin','-phylline','-pramine','-pril','-profen','-ridone','-sartan','-semide','-setron','-setron','-statin','-tadine','-tadine','-terol','-thiazide','-tinib','-trel','-tretin','-triptan','-tyline','-vir','-vir','-vir','-vir','-vir','-vudine','-zepam','-zodone','-zolam','-zosin']

def get_train_entities():
    datadir = 'data/train'
    drug_set = set()
    drug_n_set = set()
    brand_set = set()
    group_set = set()
    # process each file in input directory
    for f in listdir(datadir):
        # parse XML file, obtaining a DOM tree
        tree = parse(datadir + "/" + f)
        # process each sentence in the file
        sentences = tree.getElementsByTagName("entity")
        for s in sentences:
            text = s.attributes["text"].value  # get text
            tag = s.attributes["type"].value # get label
            if tag == 'drug':
                drug_set.add(text)
            if tag == 'drug_n':
                drug_n_set.add(text)
            if tag == 'brand':
                brand_set.add(text)
            if tag == 'group':
                group_set.add(text)
    return drug_set, drug_n_set, brand_set, group_set

def classify_token(txt):



    # drug_set = {'clofibrate', 'Amitriptyline', 'methylergonovine maleate', 'Citalopram', 'sodium acid phosphate', 'Primidone', 'Chlorpropamide', 'mefenamic acid', 'Aminoglutethimide', 'buspirone HCl', 'erythromycins', 'chlordiazepoxide', 'dipyridamole', 'cilostazol', 'chlorpropamide', 'terfenadine', 'loracarbef', 'prostaglandin F2alpha', 'ethionamide', 'dobutamine', 'tetracycline', 'Anabolic steroids', 'sulfamethoxazole', 'Azathioprine', 'aprepitant', 'Calcitriol', 'alefacept', 'Alosetron', 'cefuroxime', 'Ondansetron', 'Piperacillin sodium', 'clonidine', 'Glucose', 'Levodopa', 'butalbital', 'warfarin', 'Chlorthalidone', 'Amphotericin B', 'Thioguanine', 'glyceryl trinitrate', 'phentermine hydrochloride', 'mycophenolate', 'pertechnetate', 'thiabendazole', 'Adenosine', 'isosorbide mononitrate', 'antibiotics', 'tripelennamine', 'Zidovudine', 'stavudine', 'Dexmedetomidine', 'Moxifloxacin', 'amikacin', 'losartan', 'PGF2alpha', 'tolazoline', 'miconazole', 'ofloxacin', 'Captopril', 'pyridoxine', 'methysergide', 'troleandomycin', 'apraclonidine', 'darifenacin', 'dihydrotachysterol', 'phenylpropanolamine', 'fluorouracil', 'clonazepam', 'Aprepitant', 'Meclofenamate sodium', 'Methenamine', 'acamprosate', 'Phospholine Iodide', 'glycine', 'Diphenoxylate HCl', 'paliperidone', 'Raloxifene', 'ondansetron', 'Nimodipine', 'penciclovir', 'Bromocriptine mesylate', 'nondepolarizing agents', '99mTc-MDP', 'dextropropoxyphene', 'nitroferricyanide', 'Lithium carbonate', 'mannitol', 'acetylcysteine', 'Estazolam', 'nortriptyline', 'Eszopiclone', 'Halothane', 'norgestrel', 'Dicumarol', 'physostigmine', 'Metformin', 'letrozole', 'Dolasetron mesylate', 'oxandrolone', 'Dexrazoxane', 'clarithromycin', 'Digoxin', 'Calcium', 'penicillin G', 'vitamin E', 'sodium colistimethate', 'mercaptopurine', 'enoximone', 'naproxen sodium', 'Gentamicin', 'spironolactone', 'Mequitazine', 'modafinil', 'theophylline', 'oxytetracycline', 'Everolimus', 'norfloxacin', 'Ampicillin', 'Cimetidine', 'trimethoprim', 'clomiphene citrate', 'desloratadine', 'chlorpromazine', 'Levetiracetam', 'Carbamazepine', 'Olanzapine', 'auranofin', 'Mecamylamine', 'Oxcarbazepine', 'streptozocin', 'salsalate', 'asparaginase', 'Ethyl alcohol', 'terbinafine', 'acitretin', 'Alprazolam', 'cefmenoxime', 'icodextrin', 'fluconazole', 'dexamethasone', 'bleomycin', 'phenprocoumon', 'Haloperidol', 'corticotropin', 'oxcarbazepine', 'doxorubicin HCl', 'fenofibrate', 'Tamoxifen', 'resorcinol', 'Metoclopramide', 'Thiabendazole', 'mazindol', 'digoxin', 'dalfopristin', 'ethynyl estradiol', 'finasteride', 'HCTZ', 'tigecycline', 'dornase alfa', 'alendronate', 'Sulfoxone', 'vinorelbine', 'cefamandole', 'etretinate', 'Ethanol', 'guanadrel', 'Chlorpromazine', 'magnesium salicylate', 'Nefazodone', 'Norepinephrine', 'nisoldipine', 'Finasteride', 'nefazodone', 'Methscopolamine', 'Lomefloxacin', 'Promethazine', 'verapamil', 'cocaine', 'paricalcitol', 'Vitamin D3', 'tramadol', 'viomycin', 'allopurinol', 'pectin', 'cholestyramine', 'Sulfamethoxazole', 'Hydrochlorothiazide', 'Corticotropin', 'tolbutamide', 'alprostadil', 'capecitabine', 'Imipramine hydrochloride', 'phentolamine', 'Atropine', 'kaolin', 'Tramadol', 'theophyllines', 'ethinyl estradiol', 'pseudoephedrine', 'Nicotinic acid', 'isocarboxazid', 'cimetidine', 'antihypertensive', 'etodolac', 'tranylcypromine', 'Ketorolac', 'eplerenone', 'L-histidine', 'Cisapride', 'caspofungin', 'levonorgestrel', 'enflurane', 'Chloral hydrate', 'succinylcholine', 'DTIC', 'methdilazine', 'fenoprofen', 'duloxetine', 'tranylcypromine sulfate', 'nalidixic acid', 'Vindesine', 'sucralfate', 'diazoxide', 'cefditoren', 'thioguanine', 'Ibuprofen', 'ADL 8-2698', 'atazanavir', 'antithrombin 3', 'Fenofibrate', 'ibutilide', 'T4', 'Efavirenz', 'indomethacin', 'Cefuroxime', 'Dolasetron', 'rivastigmine tartrate', 'paclitaxel', 'penicillamine', 'Cinacalcet', 'Streptokinase', 'L-lysine', 'Telithromycin', 'chlorthalidone', 'cephalexin', 'zileuton', 'amiodarone', 'R-warfarin', 'verapamil hydrochloride', 'Nateglinide', 'aluminum', 'cis-platinum', 'Entacapone', 'sirolimus', 'rifapentine', 'Abciximab', 'Argatroban', 'praziquantel', 'fosphenytoin', 'disulfiram', 'chlorprothixene', 'alosetron', 'haloperidol', 'lithium carbonate', 'Chloramphenicol', 'dasatinib', 'probenecid', 'ezetimibe', 'Ketoconazole', 'methsuximide', 'Epinephrine', 'minocycline', 'bishydroxy-coumarin', 'Imipramine', 'guanethidine', 'oxipurinol', 'Gabapentin', 'adefovir dipivoxil', 'Scopolamine', 'Methionine', 'prednisone', 'interferon-alfa', 'linezolid', 'dideoxyinosine', 'Atovaquone', 'Stavudine', 'sodium valproate', 'carbenicillin', 'Itraconazole', 'cabergoline', 'Nicotine', 'chloroquine', 'pancuronium', 'CMI', 'pyrantel', 'olsalazine', 'Phenobarbital', 'butenafine HCl', 'succinylcholine chloride', 'vitamin C', 'bumetanide', 'ketorolac', 'Rifampin', 'colistin', 'sodium salicylate', 'Netilmicin', 'Indinavir', 'Amantadine', 'astemizole', 'HMG-CoA reductase inhibitor', 'flumazenil', 'trihexyphenidyl', 'Methylprednisolone', 'cimetidine 400 mg', 'dextrose', 'Cypermethrin', '5-fluorouracil', 'ethambutol', '99mTc-methylene diphosphonate', 'ticlopidine', 'hydrochloroquine', 'Ethosuximide', 'budesonide', 'flupenthixol', 'S warfarin', 'tamoxifen', 'acetaminophen', 'Neomycin', 'Nelfinavir', 'epinephrine', 'norethindrone acetate', 'amitriptyline', 'Warfarin', 'ethoxzolamide', 'Alcohol', 'Gentamycin', 'debrisoquin', '(S)-warfarin', 'ethacrynic acid', 'niacinamide', 'quinupristin', 'Thyroxine', 'entecavir', 'cypermethrin', 'cefazolin', 'Sucralfate', 'tannic acid', 'butorphanol', 'zinc', 'micafungin', 'hexobarbital', 'glatiramer acetate', 'clindamycin', 'EPA', 'Cysteine', 'antidiabetic', 'barbiturates', 'Propoxyphene', 'diphenoxylate hydrochloride', 'beta-interferon', 'Indomethacin', 'metaraminol', 'valproate', 'drugs', 'phenobarbital sodium', 'Methadone', 'bupropion', 'trazodone hydrochloride', 'candesartan cilexetil', 'amphotericin B', 'Caspofungin', 'dolasetron mesylate', 'somatropin', 'phenelzine sulfate', 'Potassium', 'amprenavir', 'Vecuronium', 'Spermine', 'bepridil hydrochloride', 'magnesium hydroxides', 'zonisamide', 'sildenafil', 'tranexamic acid', 'lamivudine', 'sodium bicarbonate', 'urea', 'peginterferon', 'aminosalicylic acid', 'ergonovine', 'Vitamin D2', 'PLENDIL', 'nicardipine', 'anagrelide', 'neomycin', 'Trimethoprim', 'Methyldopa', 'cefoxitin', 'cholestryramine', 'Enflurane', 'irinotecan', 'Erythromycin', 'propofol', 'Butalbital', 'tiagabine', 'Calcidiol', 'Naproxen', 'ephedrine', 'Sumatriptan', 'cardiotrast', 'fexofenadine hydrochloride', '4-methylpyrazole', 'Ranitidine', 'fondaparinux sodium', 'alpha interferons', 'glibenclamide', 'atropine sulfate', 'Lansoprazole', 'Eplerenone', 'dextran', 'polymyxin B', 'riboflavin', 'Astemizole', 'Sodium thiosulfate', 'dirithromycin', 'Morphine', 'azathioprine', 'levamisole hydrochloride', 'Monoamine Oxidase Inhibitors', 'acenocoumarol', 'buspirone', 'cinacalcet', 'antipyrine', 'aluminum hydroxide', 'Niacin', 'tolmetin', 'glycopyrrolate', 'enfuvirtide', 'triclofos sodium', 'amlodipine', 'hydrochlorothiazide', 'primidone', 'sulfasalazine', 'Terfenadine', 'citalopram', 'methylprednisolone', 'lamotrigine', 'chymotrypsin', 'Ginkgo biloba', 'atracurium', 'moclobemide', 'salicylic acid', 'atorvastatin', 'busulfan', 'Triazolam', 'nicotine', 'aminopyrine', 'Isocarboxazid', 'methadone', 'furazolidone', 'doxapram', 'anastrozole', 'imipramine', 'buprenorphine', 'quinidine', 'gabapentin', 'gefitinib', 'prochlorperazine', 'magnesium-aluminum hydroxide', 'conjugated estrogens', 'sulfinpyrazone', 'unfractionated heparin', 'disopyramide', 'procaine', 'Streptozocin', 'L-tyrosine', 'rifampin', 'cefoperazone', 'S-warfarin', 'Simvastatin', 'melphalan', 'Non-pegylated interferon alfa-2a', 'acyclovir', 'Magnesium', 'beta-adrenergic blocking agents', 'colestipol', 'simvastatin', 'lidocaine', 'delavirdine', 'vitamin B12', 'TAO', 'inactivated ND vaccine', 'cefotetan', 'dicumarol', 'charcoal', 'carbidopa', 'anakinra', 'esmolol HCl', 'propanolol', 'imipramine HCl', 'Cyclosporine', 'bitolterol', 'tenofovir', 'amphotericin', 'Vitamin E', 'Acetazolamide', 'glimepiride', 'paracetamol', 'ammonium chloride', 'MTX', 'neuroleptic', 'radiopertechnetate', 'saquinavir', 'isoflurane', 'R(+) warfarin', 'Dactinomycin', 'suxamethonium chloride', 'chlorpheniramine', 'propoxyphene hydrochloride', 'Fexofenadine', 'lorazepam', 'nimodipine', 'Nifedipine', 'Colchicine', 'nicotinamide', 'atropine', 'danazol', 'Sirolimus', 'Folic acid', 'Antiminth', 'methaqualone', 'Melatonin', 'alprazolam', 'altretamine', 'intraconazole', 'amoxicillin', 'phosphate', 'methenamine', 'Meperidine', 'Vitamin B3', 'Chlorprothixene', 'Bosentan', 'vigabatrin', 'Methotrexate', 'Isoflurane', 'Clonazepam', 'carbamazepine 10,11-epoxide', 'Mineral oil', 'glyburide', 'nabumetone', 'phenytoin sodium', 'anesthetics', 'bromocriptine mesylate', 'desipramine', 'nitroprusside', 'Pindolol', 'Losartan', 'amylase', 'irbesartan', 'cetirizine', 'Valproate', 'guanfacine', 'meclizine', 'perindopril', 'Norethindrone', 'diethylstilbestrol', 'amrinone', 'Amoxicillin', 'ziprasidone', 'meclofenamate sodium', 'dacarbazine', 'estazolam', 'S(-) warfarin', 'estradiol', 'atenolol', 'calcitriol', 'ceftibuten', 'fluoxetine', 'phenylbutazone', 'Carbidopa', 'sumatriptan succinate', 'digitoxin', 'Methysergide', 'neostigmine', 'Cyclopentolate', 'etidronate', 'ferrous sulfate', 'paraldehyde', 'exemestane', 'Dexfenfluramine', 'isoniazid', 'amphetamine', 'Soriatane', 'escitalopram', 'bacitracin', 'methicillin', 'Dexbrompheniramine', 'fosinopril', 'lymecycline', 'mexiletine', 'sumatriptan', 'sulfonylurea', 'amphetamines', 'benazepril', 'progesterone', 'hydroxychloroquine', 'pimozide', 'teniposide', 'imipramine hydrochloride', 'bishydroxycoumarin', 'carbamazepine', 'thyroid', 'testosterone', 'fenbufen', 'ganciclovir', 'cyclosporine A', 'dolasetron', 'Etonogestrel', 'Buprenorphine', 'encainide', 'Apraclonidine', 'bivalirudin', 'Furosemide', 'glipizide', 'Epirubicin', 'antidepressants', 'Propranolol', 'lopinavir', 'Antipyrine', 'Heparin', 'nitazoxanide', 'rantidine hydrochloride', 'protriptyline', 'Diphenhydramine', 'ketorolac tromethamine', 'Acamprosate', 'R warfarin', 'thiothixene', 'Hydrocortisone', 'metamizol', 'ginkgo', 'ethinylestradiol', 'salbutamol', 'abciximab', 'Vitamin B2', 'clorazepate dipotassium', 'Benzylpenicillin', 'ginseng', 'magnesium/choline salicylate', 'norepinephrine', 'diphenidol', 'Sulfamethizole', 'rifabutin', 'dopamine', 'tacrine', 'Clomipramine HCl', 'BREVIBLOC', 'carbenicillin indanyl sodium', 'Dipyridamole', 'metolazone', 'gentamycin', 'des-ciclesonide', 'telithromycin', 'Fluoxetine', 'calcium carbonate', 'adenosine', 'Diltiazem', 'olanzapine', 'Folinic acid', 'bethanechol', 'benzodiazepines', 'Glyburide', 'gold', 'Imexon', 'dihydroergotamine mesylate', 'iron', 'cyclosporine', 'cisapride', 'ertapenem', 'temazepam', 'Fondaparinux', 'Thioridazine', 'cefotaxime sodium', 'hydrocodone', 'iodamide', 'Thalidomide', 'paroxetine', 'midazolam', 'propafenone', 'T3', 'mechlorethamine', 'anti-arrhythmic', 'Pyrimethamine', 'didanosine', 'nadolol', 'alfentanil', 'ethinamate', 'milrinone', 'ethyl alcohol', 'nalbuphine', 'Clindamycin', 'warfarin sodium', 'Insulin', 'Anagrelide', 'rifampicin', 'denileukin diftitox', 'almotriptan', 'isosorbide dinitrate', 'triamterene', 'erlotinib', 'L-tryptophan', 'CCI-779', 'vecuronium', 'Probenecid', 'pancreatin', 'anisindione', 'gemifloxacin', 'fluvastatin', 'candesartan', 'epirubicin', 'apomorphine', 'Ibandronate', 'toxin', 'nicotinic acid', 'dezocine', 'antiarrhythmics', 'histamine', 'green tea gallocatechins', 'nateglinide', 'diltiazem hydrochloride', 'tricyclic antidepressants', 'Lovastatin', 'pralidoxime', 'Bretylium Tosylate', 'valproic acid', 'lansoprazole', 'Desmopressin', 'halofantrine', 'Urinary acidifying', 'papaverine', 'pioglitazone', 'Micafungin', 'metronidazole', 'sulfur', 'vancomycin', 'verografine', 'Iron', 'ciclesonide', 'lapatinib', 'Hyaluronidase', 'itraconazole', 'Didanosine', 'quinine', 'Acetaminophen', 'Lorazepam', 'Diazepam', 'Atorvastatin', 'Fenbufen', 'CYP3A4', 'Pimozide', 'Fosinopril sodium', 'nelfinavir', 'nitroglycerin', 'Dexamethasone', 'Diphenhydramine hydrochloride', 'zaleplon', 'ACTH', 'heparin', 'Ethinyl estradiol', 'egg', 'ethchlorvynol', 'entacapone', 'diazepam', 'Auranofin', 'oxolinic acid', 'pyrilamine', 'Physostigmine', 'anticoagulant', 'conivaptan', 'veratrum alkaloids', 'carbachol', 'lovastatin', 'selegiline hydrochloride', 'triacetyloleandomycin', 'nortriptyline hydrochloride', 'verografin', 'imatinib', 'S- warfarin', 'darbepoetin', 'Cyclopropane', 'tazobactam', 'CHOLESTYRAMINE', 'fexofenadine', 'hydrocortisone', 'sodium colistemethate', 'para-aminosalicylic acid', 'Nicardipine HCl', 'Bentiromide', 'mirtazapine', 'caspofungin acetate', 'Clarithromycin', 'prednisolone', 'ergocalciferol', 'INH', 'raloxifene', 'everolimus', 'cinchophen', 'triazolam', 'Castor oil', 'Metoprolol', 'fosinopril sodium', 'Lopinavir', 'glucagon', 'ciclosporin', 'Celecoxib', 'phenytoins', 'Zaleplon', 'dexrazoxane', 'atovaquone', 'Methyprylon', 'levorphanol', 'famciclovir', 'Paroxetine', 'clotrimazole', 'interferon beta-1a', 'mefloquine', 'Irinotecan', 'clobazam', 'ketamine', 'dexfenfluramine', 'dextromethorphan hydrobromide', 'sertraline', 'Quinidine', 'cisplatin', 'omeprazole', 'trazodone', 'EPO', 'Mephenytoin', 'Abacavir', 'leucovorin', 'valsartan', 'idoxuridine', 'procainamide', 'rivastigmine', 'rocuronium bromide', 'Benazepril', 'clomipramine', 'choline salicylate', 'amiloride', 'calcium acetate', 'pyrimethamine', 'tamsulosin', 'imexon', 'Flecainide', 'Nitrofurantoin', 'vaccine', 'glucose', 'ranitidine', 'reserpine', 'clozapine', 'Anakinra', 'latamoxef', 'oxybutynin', 'Verapamil', 'ketoprofen', 'Etodolac', 'Felodipine', 'levetiracetam', 'Levofloxacin', 'nilutamide', 'oxaprozin', 'thyroxin', 'imiglucerase', 'acetazolamide', 'furosemide', 'Rofecoxib', 'etoposide', 'Ergotamine', 'Omeprazole', 'fosfomycin', 'Vitamin B1', 'Glibenclamide', 'methyldopa', 'Tolbutamide', 'penicillin', 'mesalazine', 'Phenytoin', 'indinavir', 'Acebutolol', 'Acarbose', 'prilocaine', 'timolol', 'trovafloxacin', 'hydroxyurea', 'nicardipine HCl', 'cefditoren pivoxil', 'Ethoxzolamide', 'D-penicillamine', 'orphenadrine', 'NPH human insulin', 'folic acid', 'leflunomide', 'streptokinase', 'beta blockers', 'tolterodine', 'rosiglitazone', 'ipratropium', 'diltiazem', 'dextrothyroxine', 'lithium', 'Cyclosporin', 'mebendazole', 'megestrol acetate', 'vardenafil', 'Amiodarone', 'abacavir', 'rifamycin', 'dyphylline', 'enhancers', 'divalproex sodium', 'doxylamine', 'erythropoietin', 'pravastatin', 'oxymorphone', 'dofetilide', 'Dasatinib', 'potassium chloride', 'meropenem', 'hydroxychloroquine sulfate', 'retinyl acetate', 'diflunisal', 'levofloxacin', 'Nevirapine', 'loratadine', 'miconazole nitrate', 'Bepridil', 'Tenecteplase', 'CGS 21680', 'THC', 'cephalothin', 'calcium', 'Acetylcysteine', 'bosentan', 'ergot', 'Sulindac', 'zopiclone', 'Exemestane', 'pargyline', 'Valproic acid', 'Rivastigmine', 'oxytocin', 'meperidine', 'felbamate', 'ethanol', 'nitrous oxide', 'Isoniazid', 'edrophonium', 'diphenylhydantoin', 'methyprylon', 'droperidol', 'tacrolimus', 'cerivastatin', 'diuretic', 'procarbazine', 'rofecoxib', 'propantheline', 'methoxyflurane', 'levodopa', 'ribavirin', 'Tetracycline', 'boric acid', 'tricyclic antidepressant', 'noradrenaline', 'Triprolidine', 'phenobarbital', 'Diflunisal', 'bortezomib', 'codeine', 'zinc insulin', 'Terbinafine', 'Ephedrine', 'metformin', 'oxyphenbutazone', 'Sertraline', 'Thiamine', 'clofazimine', '6-MP', 'kanamycin', 'pentazocine', 'Sildenafil citrate', 'dexmedetomidine', 'melarsoprol', 'Ascorbic acid', 'Arthropan', 'tizoxanide', '1,25(OH)2D3', 'ADL-8-2698', 'drug', 'thalidomide', 'Oxandrolone', 'amantadine', 'solifenacin', 'ethosuximide', 'Ketamine', 'streptomycin', 'chlorothiazide', 'acebutolol', 'isoniazide', 'Ribavirin', 'fluvoxamine', 'cefdinir', 'surfactant', 'Cyclosporine A', 'pentobarbital', 'Bumetanide', 'Green tea polyphenols', 'progestin', 'loperamide', 'Flupenthixol', 'aminophylline', 'sulfisoxazole', 'interleukin-2', 'chloramphenicol', 'Boric acid', 'magnesium', 'Fluconazole', 'felodipine', 'sulfadoxine', 'Pilocarpine', 'lenalidomide', 'dihydroergotamine', 'buspirone hydrochloride', 'Azithromycin', 'Bexarotene', 'ciprofloxacin', 'galangin', 'dopamine HCl', 'doxorubicin HCL', 'ampicillin', 'adrenaline', 'anidulafungin', 'zidovudine', 'Tacrolimus', 'phenelzine', 'Linezolid', 'latanoprost', 'lisinopril', 'morphine', 'melatonin', 'Mitotane', 'gentamicin', 'selegiline', 'propranolol', 'propoxyphene', 'tubocurarine', 'Pantoprazole', 'Aliskiren', '(R)-warfarin', 'norethindrone', 'frovatriptan', 'fentanyl', 'Nalidixic acid', 'guafacine', 'Ritonavir', 'phenytoin', 'baclofen', 'Paliperidone', 'scopolamine', 'sympathomimetic', 'bromelains', 'erythromycin', 'piperacillin', 'Mefloquine', 'benzocaine', 'pindolol', 'aminocaproic acid', 'Midazolam', 'glutamate', 'oxycodone', 'Ethopropazine', 'inactivated ND vaccines', 'gemfibrozil', 'naratriptan', 'roxithromycin', 'aluminum hydroxides', 'Duloxetine', 'Orlistat', 'Venlafaxine', 'Ezetimibe', 'dantrolene sodium', 'risperidone', 'Mercaptopurine', 'Leucovorin', 'mycophenolate mofetil', 'desipramine hydrochloride', 'diclofenac', 'naloxone', 'magnesium hydroxide', 'Pentamidine', 'edetate calcium disodium', 'sildenafil citrate', 'Fluvastatin', 'Sildenafil', 'hydralazine', 'Allopurinol', 'amitriptyline HCl', 'pentoxifylline', 'vinblastine', 'NTG', 'carmustine', 'Dimenhydrinate', 'thioridazine', 'CYP2C9', 'cyclopropane', 'Diclofenac', 'pegylated interferon alfa-2a', 'temozolomide', 'Quetiapine fumarate', 'Vardenafil', 'medroxyprogesterone acetate', 'bexarotene', 'flutamide', 'nafarelin acetate', '5-FU', 'amyl nitrite', 'enalapril', 'azithromycin', 'niacin', 'oxacillin', 'protamine', 'infliximab', 'netilmicin', 'anticholinergic', 'Loperamide', 'oxazepam', 'n-dodecyl gallate', 'etanercept', 'Fluvoxamine', 'Benzthiazide', 'famotidine', 'Hydrocodone', 'R- warfarin', 'pantoprazole', 'Theophylline', 'Pyrantel', 'efavirenz', 'Doxylamine', 'cyclophosphamide', 'Lapatinib', 'diphenhydramine', 'tetrahydrocannabinol', 'fluphenazine', 'AZA', 'KCl', 'simethicone', 'meprobamate', 'pilocarpine', 'enoxacin', 'halothane', 'venlafaxine', 'terbutaline', 'Saquinavir', 'd-amphetamine', 'levothyroxine', 'foscarnet', 'Desloratadine', 'bismuth subsalicylate', 'ibandronate', 'mifepristone', 'NaFlu', 'mecamylamine', 'methotrexate', 'flecainide', 'corticosteroid', 'Gemfibrozil', 'oxymetazoline', 'Edetate calcium disodium', 'sparfloxacin', '6-thiouric acid', 'potassium', 'doxycycline', 'topiramate', 'celecoxib', 'inactivated AI vaccines', 'promethazine', 'Dopamine', 'Medroxyprogesterone Acetate', 'Ganciclovir', 'Riboflavin', 'Propanolol', 'ritonavir', 'methylergonovine', 'granisetron', 'metaproterenol sulfate', 'Colestipol', 'Lithium', 'cyclosporin', 'lactulose', 'ouabain', 'fluvoxamine maleate', 'fondaparinux', 'dofetillide', 'multivalent cations', 'sulindac', 'metoclopramide', 'lomefloxacin', 'diphenoxylate', 'penicillins', 'abatacept', 'hydroxyzine', 'nifedipine', 'cycloserine', 'acetylsalicylic acid', 'sulphasalazine', 'levothyroxine sodium', 'cinoxacin', 'oxygen', 'chloral hydrate', 'alcohol', 'sulphenazole', 'bezafibrate', 'anileridine', 'pergolide mesylate', 'dantrolene', 'insulin', 'ketoconazole', 'triprolidine', 'ferrous gluconate', 'allopurinol sodium', 'caffeine', 'methylphenidate', 'Metolazone', 'decitabine', 'Caffeine', 'tobramycin', 'Rifabutin', 'mesalamine', 'chlortetracycline', 'Valproic Acid', 'fluoxetine hydrochloride', 'Prednisone', 'griseofulvin', 'L-methionine', 'sodium thiosulfate', 'OXC', 'Perhexiline hydrogen maleate', 'Fosinopril', 'Amprenavir', 'Cisplatin', 'phenobarbitone', 'ergotamine', 'metrizamide', 'tenofovir disoproxil fumarate', 'levamisole', 'pentamidine', 'Cholestyramine', 'pentostatin', 'cysteine', 'captopril', 'thyroxine', 'sulfamethizole', 'secobarbital', 'eszopiclone', 'grepafloxacin', 'doxorubicin', 'glutamic acid HCl', 'thiosulfate', 'somatostatin', 'ramipril', 'voriconazole', 'Rifampicin', 'dextromethorphan', 'Azlocillin', 'ascorbic acid', 'nevirapine', 'S(-)warfarin', 'Danazol', 'procaine hydrochloride', 'naproxen', 'bromocriptine', 'metoprolol', 'ASA', 'promoter', 'CNS depressants', 'quetiapine', 'octreotide', '25-Dihydroxycholecalciferol D3', 'moxifloxacin', 'oxybutynin chloride', 'Mitomycin-C', 'Atracurium', 'ceftazidime', 'Interferon beta', 'Tiagabine', 'piroxicam', 'isoproterenol', 'glutethimide', 'ibuprofen', 'sodium fluorescein', 'dapsone', 'Fentanyl', 'lincomycin', 'Guanethidine', 'Tizoxanide', 'Calcitonin (salmon)', 'sodium nitroprusside', 'Cyclophosphamide', 'naltrexone', 'piperazine', 'aliskiren', 'terazosin'}
    # drug_n_set = {'PTX', 'N-desmethyldiazepam', 'transferrin', 'toxin A', 'CGS21680', 'carbamate insecticides', 'benzyl alcohol', 'InsP(3)', 'chondroitin ABC lyase', 'tuftsin', 'descarboethoxyloratadine', 'arsenate', 'perindoprilat', '5-DFCR', 'As(V)', 'threohydrobupropion', 'Arecoline', 'hydrodolasetron', 'bentoquatam', 'diethyl pyrocarbonate', 'NaCMC', '3-Hydroxydesloratadine', '6-beta-naltrexol', '5-DFUR', '3-[(2-methyl-1,3-thiazol-4-yl) ethynyl] pyridine', 'sodium carboxymethylcellulose', '(2-adamantyl)hexamethylenimine', 'omega-agatoxin VIA', 'hemantane', 'PABA', 'hydroxyitraconazole', 'Bombesin', 'erythrohydrobupropion', '3H-spiroperidol', 'endotoxin', 'hydroxylated fenoprofen', 'omega-conotoxin GVIA', 'resveratrol', '1-methyl-4-phenyl-1,2,3,4-tetrahydropyridine', 'L-CCG-1', 'methanol', '25-O-desacetylrifabutin', 'Phencyclidine', 'nortriptyline', 'Mineral Oil', 'L-NAME', 'desmethyldiazepam', '16,16-dimethylprostaglandin E2', 'jacalin', 'phencyclidine', 'heparinase III', 'spermidine', '(-)-NANM', 'EGF', 'alcohols', 'olprinone', 'palytoxin', 'Jacalin', 'AAV2', '5-oxo-desethylzaleplon glucuronide', 'MHD', 'Ibogaine', 'azoxymethane', 'NANM', 'phosphorous insecticides', 'fenofibric acid', 'hydroxybupropion', 'echistatin', 'norbuprenorphine', 'tyramine', 'MPTP', '4-hydroxytamoxifen', 'Resveratrol', 'D-Ala2-metenkephalinamide', 'perchlorate', 'Type II pyrethroid', 'Ganoderma lucidum extract', 'N-allylnormetazocine', 'para-aminobenzoic acid', '6-deoxy penciclovir', '5-FU', 'doxorubicinol', '18-Methoxycoronaridine', 'TAM', "John's Wort", 'methylglyoxal', '4-hydroxy-estazolam', 'phenyltoloxamine', 'omega-agatoxin IVA', '25-O-desacetyl metabolites', '4-hydroxytolbutamide', 'filipin', 'CPA', 'ruthenium red', 'GL', 'imexon', 'FBAL', 'phosphate', 'PCP', 'desmethylastermizole', 'gliftor', 'flavoridin', 'Paricalcitol', 'sodium dodecyl sulfate', 'carboxymethylcellulose-cysteine', 'ginseng stem-and-leaf saponins', 'desmethylastemizole', 'adeno-associated virus-2', '5-oxo-desethylzaleplon', 'Flavoridin', 'fosinoprilat', 'ethoxycoumarin', 'endoxifen', '1,3-difluoroacetone', 'VMA', '1-methyl-4-phenyl-1,2,3,6-tetrahydropyridine', '6MNA', 'AOM', 'Palytoxin', 'organophosphate insecticide', 'putrescine', 'thimerosal', 'hydroxylamine', '(+)-NANM', 'norfluoxetine', '8-cyclopentyl-1,3-dipropylxanthine', 'vanillin', 'GSLS', 'paraxanthine', 'DCG-IV', 'dmPGE2', 'heroin', 'lead', 'N6-cyclopentyladenosine', 'DPCPX', 'Hyaluronan lyase', 'cerulein', 'Diethyl pyrocarbonate', 'hyaluronan lyase', 'trimethyl lead', 'CMC-Cys', 'coumaphos', 'enkephalins', 'CGS 21680', 'SN38', 'Echistatin', 'Thiolated carboxymethylcellulose', 'carbamazepine 10, 11 epoxide', 'Clostridium difficile toxin A', '3-hydroxydesloratadine', 'mineral oil', 'Benzyl alcohol', 'RR', 'Gliftor', 'bombesin', 'neurotensin', 'desethyloxybutynin', 'collagenase', '1,3-difluoro-2-propanol', 'trichlorfon', 'sodium perchlorate', 'TML', '8-phenyltheophylline', 'contortrostatin', 'ibogaine', '18-MC', 'benzoxazinorifamycin', 'pyreneperone', 'beta-endorphin', 'N-methyllevallorphan', 'copper sulfate', 'vanillylmandelic acid', 'KRM-1648', 'carboxytolbutamide', 'acetaldehyde', 'reseveratrol', 'Indocyanine green', 'phenyramidol', 'ginsenosides', 'iron', '(-)-erythro-fluorocitrate', 'inositol 1,4,5-trisphosphate'}
    # group_set = {'opiates', 'Selective serotonin reuptake inhibitor (SSRI) antidepressants', 'opioid', 'MAO-inhibitors', 'Estrogens', 'calcium-channel-blocking agents', 'antiparkinsonian agents', 'thiazide diuretics', 'adrenergic drugs', 'tetracycline', 'Curariform Drugs', 'Anabolic steroids', 'Resins', 'antiplatelet agents', 'MAOI', 'hypoglycemic', 'Vitamin D', 'hypotensive agents', 'antituberculosis drug', 'butyrophenones', 'Tricyclic antidepressants', 'antibiotics', 'adrenergic agonists', 'anti-depressants', 'beta-adrenoceptor blocking agents', 'sulfonylurea agents', 'mixed agonist/antagonist analgesics', 'quinolone antimicrobial', 'anticholinergic agents', 'ganglionic peripheral adrenergic blocking drugs', 'influenza virus vaccine', 'dopa decarboxylase inhibitor', 'monoamine oxidase inhibitors (MAO-Is) Type B', 'immunosuppressive', 'Selective Serotonin Reuptake Inhibitors', 'nondepolarizing agents', 'nitrates', 'serotoninergic agents', 'anticoagulants', 'estrogens', 'resin', 'benzodiazepine class', 'botulinum neurotoxin', 'Antidiabetic drugs', 'anticonvulsant agents', 'steroid medicine', 'macrolide class', 'non-steroidal anti-inflammatory agents', 'platelet inhibitors', 'Immunosuppressants', 'thyroid products', 'tricyclics', 'contraceptives', 'salicylate', 'glitazones', 'antiestrogens', 'Beta-blocking Agents', 'Antidiabetics', 'Barbiturates', 'Salicylates', 'antibacterial drugs', 'macrolide antibacterials', 'monoamine oxidase inhibitors', '5-HT3 antagonists', 'non-steroidal antiinflammatory drugs', 'Antifungals', 'Nitrates', 'Beta-blockers', 'non-depolarising muscle relaxants', 'Fibrates', 'Digitalis Glycosides', 'blood thinners', 'analgesic agents', 'ergot alkaloids', 'muscle relaxants', 'coumarin', 'bacteriostatic antibiotic', 'monoamine oxi-dase inhibitors', 'anticholinesterase drugs', 'non-potassium sparing diuretics', 'anti-anxiety drugs', 'cardioselective beta-blocker', 'calcium-channel blockers', 'ACE inhibitors', 'nondepolarizing neuromuscular blocking agents', 'Acidifying agents', 'potassium-sparing diuretics', 'long-acting benzodiazepines', 'Hormonal Contraceptives', 'calcium blockers', 'antidepressant drugs', 'anti-infective medicines', 'antipsychotic agents', 'solvent', 'polymyxins', 'Alpha-blockers', 'antigout drugs', 'Iodinated Contrast Media', 'antihypertensive', 'SSRI antidepressants', 'thyroid hormones', 'selective Ca(2+) channel blockers', 'antihypertensive agents', 'sympathomimetic medication', 'beta2-agonists', 'prolonged narcotics', 'glucocorticoid', 'antimuscarinics', 'anticholinergics', 'Vasoconstrictors', 'Diuretic agents', 'benzodiazepine', 'Adrenergic blockers', 'vasoconstrictor drugs', 'Monoamine oxidase inhibitors', 'Antibiotics', 'sulfonamide antibiotics', 'antiarrhythmic agents', 'angiotensin converting enzyme inhibitors', 'androgens', 'Tricyclic Antidepressants', 'aminoglycoside', 'nonsteroidal anti-inflammatory drugs', 'beta-blocking agents', 'Iron Supplements', 'imidazole compounds', 'Thyroid hormones', 'Bacteriostatic Antibiotics', 'analgesic', 'TCAs', 'nonsteroial anti-inflammatory drugs', 'Cholinesterase Inhibitors', 'Calcium Antagonists', '5-HT1 agonists', 'COUMARIN ANTICOAGULANTS', 'antipsychotics', 'Antiepileptic Drugs', 'steroid', 'pulmonary surfactant', 'tricyclic antidepressant agent', 'dopamine antagonists', 'Anesthetics', 'HIV-protease inhibitors', 'thienobenzodiazepine derivative', 'antiarrhythmic agent', 'botulinum toxin', 'H1 Blockers', 'antihypertensives', 'beta adrenergic aerosol bronchodilators', 'antifungal drug', 'sulfonylureas', 'Macrolide Antibiotics', 'quinolone anti-infectives', 'antipsychotic drug', 'androgen', 'absorbent-type anti-diarrhea medicines', 'Nonsteroidal Anti-Inflammatory Drugs', 'ganglion blocking compounds', 'Nonsteroidal anti-inflammatory drugs', 'Androgens', 'xanthine bronchodilators', 'beta adrenergic blockers', 'HMG-CoA reductase inhibitor', 'Estrogen', 'conventional antipsychotics', 'beta-adrenergic blockers', 'antiretroviral', 'radiopharmaceutical', 'peripheral vasoconstrictors', 'antihypertensive medications', 'Bile acid sequestrants', 'benzodiazepenes', 'Neuromuscular blocking agents', 'therapeutic monoclonal antibodies', 'H2-Receptor Antagonists', 'NSAIDs', 'vasopressors', 'Beta-adrenergic receptor antagonists', 'progestins', 'steroid medications', 'POCs', 'Catecholamine-depleting drugs', '5-HT3 antiemetics', 'bronchodilators', 'azole antifungal', 'TNFa-blocking agents', 'alpha-adrenergic blocking agents', 'coronary vasodilators', 'hypoglycemic agents', 'Anticonvulsants', 'activated prothrombin complex concentrates', 'emetic', 'beta adrenergic antagonists', 'H 2 -receptor antagonists', 'Antidepressant', 'antidepressants of the MAO inhibitor class', 'sulphonylureas', 'antichlolinergic', 'calcium channel blocker', 'HMG-CoA reductase inhibitors', 'barbiturates', 'retinoids', 'psychostimulants', 'folic acid antagonists', 'selective serotonin reuptake inhibitors', 'prostaglandin synthetase inhibitors', 'antianxiety drugs', 'coumarin drugs', 'cytotoxic', 'succinimides', 'antidiabetic agents', 'SSRIs', 'Bisphosphonates', 'tetracycline class drugs', 'oxytocic agents', 'beta-adrenergic blocking agent', 'HDAC Inhibitors', 'non-opioid analgesics', 'MAOIs', 'estrogen', 'CNS stimulants', 'photosensitizing agents', 'Antihistamines', 'vitamin-D', 'Uricosuric Agents', 'centrally acting drugs', 'Quinolones', 'opiate analgesics', 'nitric oxide donor compounds', 'antihistamines', 'anti platelet agents', 'myocardial depressants', 'fat soluble vitamins', 'live vaccines', 'multi-minerals', 'Antiarrhythmics', 'anticoagulants of the coumarin type', 'potassium- sparing diuretics', 'beta-agonists', 'beta adrenergic agonists', 'Antiplatelet Agents', 'Anti-arrhythmics', 'Monoamine Oxidase Inhibitors', 'belladonna alkaloids', 'sympathomimetic amine', 'lung surfactant', 'macrolides', 'multivitamins', 'ANTICOAGULANTS', 'cyclic antidepressants', 'dialysis solutions', 'Coumarin-Derivative Anticoagulants', 'digitalis glycosides', 'Anticholinesterases', 'Antiretroviral', 'Tetracyclines', 'antihistaminics', 'antidepressant drug', 'contraceptive product', 'combined oral contraceptives', 'aminoglycosides', '5-HT1B/1D Agonists', 'live organism vaccines', 'imidazole drugs', 'quinidine', 'antidiabetic drug', 'narcotic analgesics', 'azole antifungals', 'beta-adrenergic blocking agents', 'Killed virus vaccines', 'NSAID', 'non- steroidal antiinflammatory agent', 'Thyroid preparations', 'adrenergic bronchodilators', 'Antacid', 'tricyclic anti-depressants', 'angiotensin-converting enzyme inhibitors', 'cyclooxygenase-2 inhibitors', 'anticholinergic medications', 'neuroleptic', 'synthetic steroidal estrogen', 'pyrazolones', 'ACE Inhibitors', 'non-depolarizing muscle relaxants', 'Sulfonamides', 'Cholinomimetics', 'multivitamin preparations', 'quinolone antibiotics', 'neuroleptics', 'MAO inhibitors', 'phenothiazines', 'avian influenza vaccines', 'anticoagulant agents', 'anti-neoplastic agents', 'salicylates', 'Adrenergic Agents', 'Non-steroidal Anti-inflammatory Agents', 'Urinary acidifying agents', 'sympathomimetic amines', 'Broad-spectrum antibiotics', 'anesthetics', 'combined hormonal contraceptives', 'fluoroquinolone antibiotics', 'contraceptive', 'rauwolfia alkaloid', 'Hypoglycemics', 'protease inhibitors', 'Ergot', 'proton pump inhibitors', 'ergot alkaloid drugs', 'beta-adrenergic-blocking agents', 'Proton Pump Inhibitors', 'T.A.', 'nonsteroidal anti-inflammatory agents', 'phenylbutazone', 'quinolones', 'TNF antagonists', 'alpha-blockers', 'hypnotic medications', 'H1-blocking agents', 'anti-pseudomonal antibiotics', 'Loop Diuretics', 'Selective serotonin reuptake inhibitors', 'progestational contraceptives', 'Phenothiazines', 'TNF-blocking agents', 'amphetamine', 'bacitracin', 'adrenal cortical steroids', 'decongestant drugs', 'glucocorticoids', 'Monoamine oxidase (MAO) inhibitors', 'cholinesterase inhibitors', 'phenothiazine', 'thiazides', 'sulfonylurea', 'thyroid drugs', 'amphetamines', 'uricosurics', 'MAO-A inhibitors', 'thyroid', 'RESIN', 'coumarin-type anticoagulants', 'psychotropics', 'Adrenal steroids', 'aminosalicylate derivatives', 'tricyclic drugs', 'non-steroidal anti-inflammatory drugs', 'antacid', 'monoamine oxidase inhibitor', 'curariform drugs', 'antihistaminic', 'nitrate', 'antiparkinson drugs', 'diuretics', 'antidepressants', 'imidazole', 'dopaminergic agents', 'coagulation factor', 'tricyclic antidepressant class', 'Serotonergic Agents', 'aminoglycoside antibiotic', 'analgesic drugs', 'non-selective beta-adrenergic-blocking agents', 'beta blocking agents', 'ACEI', 'CNS depressant', 'delta(1)-selective opioids', 'thyroid preparation', 'polyene antibiotics', 'adrenocortical steroids', 'antiparkinsonian drug', 'opioid agonist analgesic', 'aminoglycosidic antibiotics', 'fat-soluble vitamins', 'reverse transcriptase inhibitors', 'sympathomimetic pressor amines', 'AED', 'anesthetic solutions', 'anticoagulants of the warfarin type', 'histamine H2-receptor antagonists', 'Statins', 'benzodiazepines', 'Veratrum alkaloids', 'b-blocking drug', 'gold', 'digitalis preparations', 'thrombolytic agents', 'nitrites', 'antimalarials', 'psychotropic medications', 'Nonsteroidal Antiinflammatory Drug', 'macrolide products', 'hydantoins', 'nondepolarizing muscle relaxants', 'sympathomimetic drugs', 'Antiretroviral Drugs', 'Diuretics', 'adrenocortical steroid', 'Amphetamines', 'non-steroidal anti-inflammatory agent', 'vitamin K', 'anticoagulant medication', 'antiemetics', 'analgesic adjuvants', 'thioxanthene classes of antipsychotic agents', 'antiarrhythmics', 'serotonin reuptake inhibitor drug', 'antimicrobial agents', 'Cardiac Glycosides', 'vitamin', 'tricyclic antidepressants', 'immunosuppressants', 'coumarins', 'azole antimycotics', 'warfarin-type anticoagulant', 'iodine', 'Anticoagulants', 'TNF-blocking agent', 'hormonal contraceptive', 'anion-exchange resins', 'H2 Blockers', 'Antidepressants', 'kappa-selective opioids', 'H2-antagonists', 'angiotensin II receptor antagonists', 'phenylalkylamine', 'Antithrombotics', 'coumarin anticoagulants', 'anticonvulsant', 'progestogens', 'b-lactam antibiotics', 'thiazide-like diuretics', 'antidiabetics', 'antiestrogen', 'immuno-suppressant', 'antihypertensive drugs', 'beta-adrenergic blocking drug', 'monoamine oxidase (MAO) inhibitors', 'Narcotics', 'acidifying agents', 'H2 blockers', 'second generation (atypical) antipsychotic agent', 'Beta-adrenergic blocking drugs', 'sedative', 'inactivated vaccines', 'calcium channel-blocking drugs', 'ACTH', 'azoles', 'Insulins', 'Mixed Agonist/Antagonist Opioid Analgesics', 'digestive enzyme preparations', 'anesthetic agents', 'Agonist/antagonist analgesics', 'anticoagulant', 'beta-adrenergic receptor blockers', 'veratrum alkaloids', 'neuromuscular blocking agents', 'fibric acid derivatives', 'nonbarbiturate hypnotics', 'HIV protease inhibitors', 'Gastrointestinal acidifying agents', 'somatostatin analog', 'histamine H2 receptor antagonist', 'antianxiety agents', 'synthetic 3-hydroxy-3-methylglutaryl coenzyme A (HMGCoA) reductase inhibitor', 'thrombolytics', 'live typhoid vaccines', 'estrogen antagonist', 'Aminoglycosides', 'antifungal agents', 'immunosuppressive drugs', 'psychotropic agents', 'antibiotic agents', 'Digitalis', 'beta-agonist', 'Non-Steroidal Anti-Inflammatory Drugs', 'loop diuretics', 'uricosuric agents', 'sulfonamide', 'anti-cancer drugs', 'antivirals', 'calcium channel blockers', 'azole antifungal agents', 'H2 receptor antagonists', '(beta)-agonists', 'halogenated hydrocarbon general anesthetics', 'hydroxymethylglutaryl coenzyme A (HMG-CoA) reductase inhibitors', 'vitamin D preparations', 'antihyperlipidemics', 'Broad-Spectrum Antibiotics', 'vitamin K antagonists', 'diphosphonates', 'vaccine', 'organic nitrates', 'hypnotics', 'Vasopressors', 'Protease Inhibitors', 'central nervous system stimulants', 'barbituates', 'vasoconstrictor agents', 'muscle relaxant', 'opioid analgesics', 'coumarin-derivative anticoagulants', 'Sympathomimetics', 'Non-selective MAO inhibitors', 'POC', 'Beta Blockers', 'HIV Protease Inhibitors', 'dopamine agonists', 'quinolone class', 'calcium channel antagonists', 'cephalosporin antibiotics', 'CNS-depressant drug', 'vasodilators', 'cardioselective beta-blockers', 'penicillin', 'Steroids', 'non-steroidal anti-inflammatory', 'steroids', 'major tranquilizers', 'interleukin-1 antagonist', 'Ergot-Containing Drugs', 'cephalosporin', 'tetracycline class', 'antacids', 'muscle relaxant drugs', 'alpha-blocker', 'coumarin derivatives', 'hormonal contraceptives', 'beta-adrenergic antagonists', 'Butyrophenones', 'beta blockers', 'nonsteroidal anti-inflammatory drug', 'thyroid hormone', 'butyrophenone classes of antipsychotic agents', 'hormonal contraceptive agents', 'Intestinal adsorbents', 'broad-spectrum antibiotics', 'salicylate analgesics', 'Antiepileptic drugs', 'sedatives', 'antidiabetic products', 'pure agonist opioid analgesic', 'HMG-CoA reductase inhibitor class', 'Macrolide antibiotics', 'tranquillisers', 'calcineurin inhibitor', 'topoisomerase-targeting antitumor drugs', 'vaccines', 'selective serotonin reuptake inhibitor', 'catecholamines', 'sulfonamides', 'dihydropyridine calcium antagonists', 'CNS depressant drugs', 'phenothiazines classes of antipsychotic agents', 'fibrates', 'bile acid sequestrants', 'Fluoroquinolones', 'iron supplement', 'H 2 receptor antagonists', 'anti-malarial drugs', 'Beta-adrenergic blocking agents', 'anti-helminthic', 'sedative-hypnotics', 'MAOI antidepressants', 'sex steroids', 'organophosphorous compound', 'narcotics', 'multi minerals', 'H1 blockers', 'cholinergic agonists', 'macrolide antibiotics', 'carbonic anhydrase inhibitors', 'Cephalosporins', 'diagnostic monoclonal antibodies', 'hypoglycemics', 'sympathomimetic agents', 'diuretic', 'long-acting benzodiazepine', 'anticonvulsant medications', 'antacid products', 'indanedione anticoagulants', 'quinolone', 'Antiretroviral Agents', 'diuretic agents', 'beta blocker', 'psychotropic drugs', 'tricyclic antidepressant', 'beta-blockers', 'Psychoactive Drugs', 'statins', 'anticholinesterase', 'Thrombolytic agents', 'synthetic steroidal progestogen', 'gold medication', 'Sympathomimetic amines', 'vitamin A', 'benzothiazepine', 'antibiotic', 'hypnotic agent', 'anticholinergic agent', 'methylxanthines', 'beta-lactam antibiotics', 'Contraceptive', 'decongestants', 'Antacids', 'statin', 'bile acid binding resin', 'Hypoglycemic Agents', 'thiazolidinediones', 'central nervous system depressants', 'digitalis', 'Antihypertensive', 'anxiolytics', 'Potassium-Sparing Diuretics', 'fluoroquinolone antibiotic', 'alpha-2 agonists', 'progestin', 'non- steroidal anti- inflammatory agents', 'magnesium', 'hypotensive drugs', 'anticonvulsants', 'Antiplatelets', 'anticonvulsant drugs', 'Diuretic', 'hydrazine derivatives', 'Cardiac glycosides', 'tricyclic', 'potassium-sparing antihypertensives', 'tetracyclines', 'beta-adrenergic blocker', 'diphosphonate', 'xanthine derivatives', 'PPIs', 'calcium antagonists', 'Thyroid hormone', 'vitamin D analogues', 'Angiotensin II Receptor Antagonists', 'Beta-adrenergic Blocking Agents', 'contraceptive agents', 'Nondepolarizing Muscle Relaxants', 'psychoactive drugs', 'sympathomimetics', 'opioids', 'antithrombotic agent', 'Gold', 'platelet aggregation inhibitors', 'sympathomimetic', 'MAO inhibitor', 'Noncardioselective beta-blockers', 'cardiac glycosides', 'curare-like compounds', 'SSRI', 'Potassium-sparing diuretics', 'adrenergic neuron blocking agents', 'beta adrenergic blocking agents', 'vasoconstrictors', 'selective opioid agonists', 'prothrombin complex concentrates', 'Beta-Blockers', 'adrenergic beta-receptor blockers', 'antifungals', 'dopa-decarboxylase inhibitor', 'central nervous system depressant', 'quinolone class antimicrobial', 'cytotoxic agents', 'Angiotensln Converting Enzyme Inhibitors', 'Non-steroidal Anti-inflammatory Drugs', 'halogenated hydrocarbon anesthetics', 'antiretroviral medications', 'beta-blocker', 'anticholinergic drugs', 'peripherally restricted opioid antagonist', 'vasopressor drugs', 'Digitalis glycosides', 'vitamins', 'vasopressor', 'ergot alkaloid class', 'skeletal muscle relaxants', 'Nonsteroidal anti-inflammatory agents', 'Anticholinergic agents', 'central nervous system (CNS) depressants', 'live attenuated vaccines', 'sympathomimetic bronchodilators', 'triazolobenzodiazepines', 'antituberculous drugs', 'corticosteroids', 'antidepressant', 'Vitamin K', 'tranquilizers', 'adrenergic', 'Angiotensin Converting Enzyme (ACE) inhibitors', 'Antipsychotic drugs', 'H2 antagonists', 'anabolic steroids', 'Opiate agonists', 'Antihypertensives', 'antineoplastic agents', 'antiglaucoma agents', 'Calcium channel blockers', 'NSAIDS', 'anticholinergic', 'Dopamine antagonists', 'antibacterial drug', 'radiographic iodinated contrast media', 'fibrate drugs', 'anti-arrhythmic agents', 'thioxanthines', 'progestin-only oral contraceptives', 'MAO Inhibitors', 'ganglionic blocking agents', 'anticholinesterase agents', 'antihypertensive compounds', 'ergot-type medications', 'nasal vasoconstrictor', 'Coumarin Anticoagulants', 'Type 1C antiarrhythmics', 'TCA', 'Corticosteroids', 'non-selective MAO inhibitor', 'calcium channel blocking agents', 'atypical antipsychotic', 'TNF antagonist', 'iron supplements', 'HMGCoA reductase inhibitors', 'corticosteroid', 'nonsteroidal anti-inflammatory', 'thiazide-type diuretics', 'Cytotoxic Agents', 'Salicylate', 'antiepileptic drugs', 'ARB', 'fluoroquinolones', 'Quinolone Antibiotics', 'angiotensin-converting enzyme (ACE) inhibitors', 'Thiazide Diuretics', 'antibiotic drug', 'narcotic', 'aminoglycoside antibiotics', 'phenothiazine derivatives', 'analgesics', 'immunodepressant', 'Vitamin A', 'Skeletal muscle relaxants', 'penicillins', 'antidiabetic drugs', 'b-lactams', 'anaesthetic agents', 'thyroid preparations', 'CNS depressant medications', 'HDAC inhibitors', 'insulins', 'Benzodiazepines', 'Anticholinergics', 'ergot-type oxytocic drugs', 'retinoid', 'antiretroviral medication', 'MAO-B inhibitor', 'low molecular weight heparins', 'short-acting benzodiazepines', 'adrenergic agents', 'antimycotic agents', 'anticoagulant drugs', 'ganglion blockers', 'antidepressant agents', 'glycosides', 'monoamine oxidase inhibiting drugs', 'hydantoin', 'anticholinesterases', 'chemotherapeutic agents', 'Anticholinergic drugs', 'anti-parkinsonian drug', '5-HT1B/1D agonists', 'serotonin reuptake inhibitors', 'mu-selective opioids', 'calcium channel blocking drugs', 'Thiazides', 'alpha-adrenergic stimulants', 'opiate', 'Live virus vaccines', 'antianginals', 'nonsteroidal antiinflammatory agents', 'Beta adrenergic agonists', 'anionic exchange resins', 'catecholamine depletors', 'Calcium channel blocking agents', 'CNS depression-producing drugs', 'bisphosphonates', 'antidiabetic medication', 'dihydropyridine calcium channel blockers', 'Contraceptives', 'Dopamine D2 receptor antagonists', 'oxytocic drugs', 'CNS depressants', 'Central nervous system depressant', 'resins', 'dopamine agonist', 'AEDs', 'Central Nervous System Depressants', 'antiplatelet medication', 'ACE inhibitor', 'anesthetic', 'TNF blocking agents', 'serotonergic agents', 'immunomodulating drugs', 'vitamin D', 'Vaccines', 'cephalosporins', 'Ergot alkaloids'}
    # brand_set = {'gelusil', 'Maalox TC', 'Thorazine', 'BUSULFEX', 'TRISENOX', 'Medrol', 'SUBOXONE', 'Gantanol', 'HUMIRA', 'Cefizox', 'Marplan', 'LEVSIN', 'Prozac', 'DIDREX', 'Leukine', 'Naprosyn', 'ALLEGRA', 'ZYVOX', 'ZOLADEX', 'Orasone', 'aspirin', 'Kadian', 'PRINIVIL', 'Plenaxis', 'Purinethol', 'Antizol', 'NIZORAL', 'ZERIT', 'Advil', 'Lovenox', 'COPEGUS', 'Hydrodiuril', 'Magan', 'Cytadren', 'AVONEX', 'Permax', 'Adenocard', 'ELSPAR', 'VISTIDE', 'UROXATRAL', 'Rifadin', 'Septra', 'REVLIMID', 'Methergine', 'Sporanox', 'BARACLUDE', 'Pulmozyme', 'ERGOMAR', 'Zofran', 'Zmax', 'VAPRISOL', 'Pediapred', 'Neulasta', 'ENBREL', 'Tegretol', 'Invirase', 'Ponstel', 'Geocillin', 'sandimmune', 'ProSom', 'TYKERB', 'Zarontin', 'Femara', 'Gris-PEG', 'EULEXIN', 'ZADAXIN', 'Omniscan', 'MONUROL', 'DITROPAN XL', 'Soliris', 'Trecator', 'Cerebyx', 'HERCEPTIN', 'TRANXENE', 'COLAZAL', 'Gleevec', 'ZETIA', 'NovoSeven', 'Bezalip retard', 'Oruvail', 'Cataflam', 'IOPIDINE', 'Posicor', 'Disalcid', 'LEUSTATIN', 'Nimotop', 'TEMODAR', 'Parnate', 'Sectral', 'INOmax', 'Viagra', 'Orudis', 'VERSED Syrup', 'Prolixin', 'Topamax', 'IRESSA', 'Phenergan', 'TOLECTIN', 'Theo-Dur', 'Anaprox', 'Trilisate', 'Sensipar', 'Permitil', 'Prostigmin', 'Norvir', 'Chloromycetin', 'PROCRIT', 'Targretin', 'Crixivan', 'Pepto-Bismol', 'Antabuse', 'TRACLEER', 'Mentax', 'Aranesp', 'AMERGE', 'Eldepryl', 'ZINECARD', 'Celexa', 'LEVULAN KERASTICK', 'Natrecor', 'DOXIL', 'NEUPOGEN', 'Xigris', 'Coumadin', 'Nizoral', 'OMNICEF', 'ROMAZICON', 'Ultram', 'ORENCIA', 'Kytril', 'Bactrim', 'REGRANEX', 'VESIcare', 'Dantrium', 'Lopressor', 'FLUDARA', 'WelChol', 'Aleve', 'PROPECIA', 'IMITREX', 'LODOSYN', 'REMICADE', 'VUMON', 'TAXOL', 'Starlix', 'Neoral', 'FLEXERIL', 'Compazine', 'ATACAND', 'Soriatane', 'Survanta', 'Nydrazid', 'NovoLog', 'ACEON', 'Robinul', 'DIFFERIN', 'PEGASYS', 'Voltaren', 'Atromid-S', 'Zemplar', 'LEXAPRO', 'NORVIR', 'Lodine', 'ZEVALIN', 'Imuran', 'Deltasone', 'Rifamate', 'Gantrisin', 'TORADOL', 'Lipitor', 'INAPSINE', 'SUBUTEX', 'BREVIBLOC', 'VIDEX', 'Trecator-SC', 'MEXITIL', 'Matulane', 'Penthrane', 'EVISTA', 'Prostin VR Pediatric', 'AVASTIN', 'FLUOTHANE', 'TOBI', 'Aspirin', 'Lotensin', 'PULMOZYME', 'EQUETROTM', 'Solganal', 'TYSABRI', 'STADOL NS', 'REMERON', 'SYNAREL', 'PROSTIN E2', 'Activase', 'Vitrasert', 'Ocupress', 'PROSCAR', 'Nardil', 'Depen', 'MEVACOR', 'PROLEUKIN', 'Ritalin', 'Ortho-Novum', 'Relafen', 'DOSTINEX', 'Cerezyme', 'Streptase', 'ZEBETA', 'EMCYT', 'Keppra', 'ZEMURON', 'VIOXX', 'Calan SR', 'TAMBOCOR', 'LAMISIL', 'MIVACRON', 'Inderal', 'Diuril', 'Maalox', 'AKINETON', 'Vidaza', 'Sonata', 'TARCEVA', 'SULAR', 'FACTIVE', 'DURAGESIC', 'INSPRA', 'Pletal', 'GABITRIL', 'ALKERAN', 'ENABLEX', 'FROVA', 'REMERON SolTab', 'AUGMENTIN XR', 'Imitrex', 'REFLUDAN', 'Bezalip', 'co-trimoxazole', 'Felbatol', 'CEFOTAN', 'NUROMAX', 'Alupent', 'Rocaltrol', 'PIPRACIL', 'TABLOID', 'MYCAMINE', 'Tagamet', 'SPRYCEL', 'Seroquel', 'Desyrel', 'Agenerase', 'Exelon', 'Cetrotide', 'ERGAMISOL', 'HEMABATE', 'NIMBEX', 'Mylotarg', 'Factrel', 'TRICOR', 'MEPRON', 'Kineret', 'Keflex', 'ZIAGEN', 'rifadin', 'INVEGA', 'Implanon', 'Myochrysine', 'Trileptal', 'Kaletra', 'Astramorph', 'Sanctura', 'Retavase', 'ALIMTA', 'Tiazac', 'DILAUDID', 'INDOCIN', 'EDECRIN', 'HEXALEN', 'Prelone', 'Indocin', 'AMEVIVE', 'FELDENE', 'PLETAL', 'ERBITUX', 'Caverject', 'Nalfon', 'TNKase', 'BOTOX', 'EXTRANEAL', 'PERSANTINE', 'MYKROX', 'Angiomax', 'Mexitil', 'KEMSTRO', 'SKELAXIN', 'CANCIDAS', 'PEG-Intron', 'PURINETHOL', 'AXERT', 'DIAMOX', 'Aricept', 'EMTRIVA', 'Sandimmune', 'VELCADE', 'MS Contin', 'MICRONASE', 'Viracept', 'Motrin', 'Pronestyl', 'Dilantin', 'Anafranil', 'METROGEL', 'TRENTAL', 'Betaseron', 'Cuprimine', 'Tylenol', 'Levo-Dromoran', 'DETROL LA', 'KEMSTROTM', 'Daypro', 'ZAVESCA', 'Azulfidine', 'BROVANA', 'Celontin', 'WELLBUTRIN', 'ELLENCE', 'Nuprin', 'ETHYOL', 'Neurontin', 'ZOLINZA', 'Tilade', 'Tenormin', 'D.H.E. 45', 'ZANOSAR', 'Lamprene', 'Fortovase', 'Videx', 'COPAXONE', 'ELDEPRYL', 'CASODEX', 'Orudis KT', 'SPIRIVA'}
    # WARNING: This function must be extended with
    #          more and better rules

    for suffix in all_drug_suffix:
        if len(txt) >= len(suffix):
            if txt[-(len(suffix)-1):] == suffix[1:]:
                return "drug"
    for prefix in all_drug_prefix:
        if len(txt) >= len(prefix):
            if txt[:(len(prefix)-1):] == prefix[:-1]:
                return "drug"

    if txt.lower() in external : return external[txt.lower()]
    elif txt[-6:] in suffix_drug_n: return "drug_n"
    # elif txt in drug_n_set: return "drug_n"
    # elif txt in group_set: return "group"
    # elif txt in drug_set: return "drug"
    # elif txt in brand_set: return "brand"
    # elif txt.isupper() : return "brand"
    # elif txt[-5:] in suffixes_5 : return "drug"
    # elif txt[-3:] in suffixes_3 : return "drug"
    else : return "NONE"

   

## --------- Entity extractor ----------- 
## -- Extract drug entities from given text and return them as
## -- a list of dictionaries with keys "offset", "text", and "type"

def extract_entities(stext) :

    # WARNING: This function must be extended to
    #          deal with multi-token entities.
    
    # tokenize text
    tokens = tokenize(stext)
         
    result = []
    # classify each token and decide whether it is an entity.
    for (token_txt, token_start, token_end)  in tokens:
        drug_type = classify_token(token_txt)
        
        if drug_type != "NONE" :
            e = { "offset" : str(token_start)+"-"+str(token_end),
                  "text" : stext[token_start:token_end+1],
                  "type" : drug_type
                 }
            result.append(e)
                    
    return result
      
## --------- main function ----------- 

def nerc(datadir, outfile) :
   
    # open file to write results
    outf = open(outfile, 'w')

    # process each file in input directory
    for f in listdir(datadir) :
      
        # parse XML file, obtaining a DOM tree
        tree = parse(datadir+"/"+f)
      
        # process each sentence in the file
        sentences = tree.getElementsByTagName("sentence")
        for s in sentences :
            sid = s.attributes["id"].value   # get sentence id
            stext = s.attributes["text"].value   # get sentence text

            # extract entities in text
            entities = extract_entities(stext)
            #return_desired_entities(entities, 'drug_n')
         
            # print sentence entities in format requested for evaluation
            for e in entities :
                print(sid,
                      e["offset"],
                      e["text"],
                      e["type"],
                      sep = "|",
                      file=outf)
            
    outf.close()

def return_desired_entities(entities, label):
    for entity in entities:
        for dictionary in entities:
            print(f"{dictionary['text']} - {dictionary['type']}")
   
## --------- MAIN PROGRAM ----------- 
## --
## -- Usage:  baseline-NER.py target-dir
## --
## -- Extracts Drug NE from all XML files in target-dir
## --

# directory with files to process
datadir = sys.argv[1]
outfile = sys.argv[2]

drug_set, drug_n_set, brand_set, group_set = get_train_entities()

nerc(datadir, outfile)

evaluator.evaluate("NER", datadir, outfile)





















